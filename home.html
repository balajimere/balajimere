<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shree Balaji Oil Agency</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{--green:#03A64A}
body{margin:0;font-family:Arial;background:#f7f7f7}
header{
 background:var(--green);color:#fff;
 text-align:center;padding:14px;
 font-size:20px;font-weight:bold;
 position:relative
}

/* MENU BUTTON */
.menu-btn{
 position:absolute;left:12px;top:12px;
 font-size:22px;cursor:pointer
}

/* SIDE MENU */
.side-menu{
 position:fixed;top:0;left:-260px;
 width:260px;height:100%;
 background:#fff;z-index:20;
 box-shadow:2px 0 8px rgba(0,0,0,.2);
 padding:15px;transition:.3s
}
.side-menu a{
 display:block;padding:10px;
 border-bottom:1px solid #ddd;
 text-decoration:none;color:#333
}
.side-menu .close{
 font-size:18px;text-align:right;
 cursor:pointer;margin-bottom:10px
}

/* STATUS BAR */
.status-bar{display:flex;overflow-x:auto;padding:10px;background:#fff;scroll-behavior:smooth}
.story{min-width:70px;text-align:center;margin-right:10px;cursor:pointer}
.story img{width:60px;height:60px;border-radius:50%;border:3px solid #03A64A;object-fit:cover}
.story.seen img{border-color:#999}
.story span{font-size:12px}

/* EXISTING CSS */
.top-tools{display:flex;gap:8px;padding:10px;background:#fff;position:sticky;top:0;z-index:5}
.top-tools input,.top-tools select{width:100%;padding:8px;border:1px solid #ccc;border-radius:6px}
.category{padding:10px;font-size:18px;font-weight:bold;color:#333}

.products{
 padding:12px;
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
 gap:12px;
 margin-bottom:90px
}

/* FORCE 2 PRODUCTS ON MOBILE */
@media(max-width:600px){
 .products{grid-template-columns:repeat(2,1fr)}
}

.card{background:#fff;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.1);overflow:hidden}
.slider{position:relative;overflow:hidden}
.slider-track{display:flex;transition:.4s}
.slider img{width:100%;height:200px;object-fit:cover;flex-shrink:0;cursor:pointer}
.slide-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.4);color:#fff;border:none;padding:6px 10px;cursor:pointer;font-size:18px}
.prev{left:5px}.next{right:5px}

.info{padding:10px}
.price{color:var(--green);font-weight:bold}
.mrp{text-decoration:line-through;color:#999;font-size:13px}

.actions{display:flex;gap:6px;margin-top:8px}
.actions button{flex:1;padding:8px;border:none;border-radius:6px;color:#fff;font-size:13px;cursor:pointer}
.cart{background:#ff9800}
.share{background:#555}

.bottom-nav{
 position:fixed;bottom:0;left:0;width:100%;
 background:#fff;border-top:1px solid #ddd;
 display:flex;justify-content:space-around;padding:8px 0
}
.bottom-nav i{font-size:22px;color:var(--green)}
</style>
</head>

<body>

<header>
 <i class="fa-solid fa-bars menu-btn" onclick="openMenu()"></i>
 Shree Balaji Oil Agency
</header>

<div class="side-menu" id="sideMenu">
 <div class="close" onclick="closeMenu()">âœ–</div>
 <a href="profile.html">Profile</a>
 <a href="contact.html">Contact</a>
 <a href="career.html">Carrier</a>
 <a href="franchise.html">Franchise Partner</a>
 <a href="referral.html">Referral</a>
 <a href="about.html">About</a>
 <a href="terms.html">Terms & Conditions</a>
 <a href="privacy.html">Privacy</a>
</div>

<div class="status-bar" id="statusBar"></div>

<div class="top-tools">
 <input type="text" id="searchBox" placeholder="Search product..." oninput="render()">
 <select id="catFilter" onchange="render()">
  <option value="">All Categories</option>
 </select>
</div>

<div id="productList"></div>

<div class="bottom-nav">
  <i class="fa-solid fa-box" onclick="location.href='order.html'"></i>
  <i class="fa-solid fa-user" onclick="location.href='login.html'"></i>
  <i class="fa-solid fa-cart-shopping" onclick="location.href='cart.html'"></i>
</div>

<script>
function openMenu(){sideMenu.style.left="0"}
function closeMenu(){sideMenu.style.left="-260px"}
</script>

<!-- ðŸ”½ YOUR ORIGINAL SCRIPT UNCHANGED ðŸ”½ -->
<script>
firebase.initializeApp({
  apiKey: "AIzaSyCt99elKr4T1OJihGpQ6t2luYmCmEBJeo0",
  authDomain: "balajimere-c8eb9.firebaseapp.com",
  projectId: "balajimere-c8eb9"
});

const db=firebase.firestore();
let ALL=[];
db.collection("status").orderBy("time","desc").onSnapshot(s=>{
 statusBar.innerHTML="";
 let seen = JSON.parse(localStorage.getItem("seenStatus")||"[]");
 s.forEach(d=>{
  let st=d.data();
  let thumb = st.images && st.images[0] ? st.images[0] : "https://via.placeholder.com/60";
  let isSeen = seen.includes(d.id);
  statusBar.innerHTML+=`
   <div class="story ${isSeen?"seen":""}" onclick="openStatus('${d.id}')">
    <img src="${thumb}">
    <span>${st.category || "Status"}</span>
   </div>`;
 });
});

setInterval(()=>{
 statusBar.scrollLeft += 80;
 if(statusBar.scrollLeft >= statusBar.scrollWidth - statusBar.clientWidth){
  statusBar.scrollLeft = 0;
 }
},2500);

function openStatus(id){
 let seen = JSON.parse(localStorage.getItem("seenStatus")||"[]");
 if(!seen.includes(id)){seen.push(id);localStorage.setItem("seenStatus",JSON.stringify(seen));}
 location.href="status.html?id="+id;
}
function isLogin(){return localStorage.getItem("user");}
db.collection("products").where("hidden","!=",true).onSnapshot(snap=>{
 ALL=[];let cats=new Set();
 snap.forEach(d=>{let p=d.data();p.id=d.id;ALL.push(p);cats.add(p.category||"Other");});
 catFilter.innerHTML='<option value="">All Categories</option>';
 cats.forEach(c=>catFilter.innerHTML+=`<option>${c}</option>`);
 render();
});
function render(){
 let list=document.getElementById("productList");list.innerHTML="";
 let search=searchBox.value.toLowerCase();let cat=catFilter.value;
 let data=ALL.filter(p=>(!cat||p.category==cat)&&p.name.toLowerCase().includes(search));
 let group={};
 data.forEach(p=>{let c=p.category||"Other";if(!group[c])group[c]=[];group[c].push(p);});
 Object.keys(group).forEach(cat=>{
  list.innerHTML+=`<div class="category">${cat}</div><div class="products">`;
  group[cat].forEach(p=>{
   let imgs=p.images?.length?p.images:[p.image];
   let slides=imgs.map(i=>`<img src="${i}" onclick="view('${p.id}')">`).join("");
   list.innerHTML+=`
   <div class="card">
    <div class="slider"><div class="slider-track">${slides}</div></div>
    <div class="info">
     <b>${p.name}</b><br>
     <span class="price">â‚¹${p.price}</span>
     <span class="mrp">â‚¹${p.mrp||""}</span>
     <div class="actions">
      <button class="cart" onclick='addCart(${JSON.stringify(p)})'>Buy Now</button>
      <button class="share" onclick="share('${p.name}')">Share</button>
     </div>
    </div>
   </div>`;
  });
  list.innerHTML+=`</div>`;
 });
}
function view(id){location.href="view-product.html?id="+id;}
function addCart(p){
 if(!isLogin()) return location.href="login.html";
 let q=prompt("Quantity?");if(!q||q<=0) return;
 let c=JSON.parse(localStorage.getItem("cart")||"[]");
 c.push({...p,qty:q});
 localStorage.setItem("cart",JSON.stringify(c));
 location.href="cart.html";
}
function share(name){
 navigator.share?navigator.share({title:name,text:name,url:location.href}):window.open(`https://wa.me/?text=${name}`);
}
</script>

</body>
</html>
